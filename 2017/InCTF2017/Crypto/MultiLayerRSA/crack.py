# Wieners attack source
# https://github.com/ctfs/write-ups-2015/blob/master/plaidctf-2015/crypto/curious/wiener_attack.py

encryption_keys = [34961, 3617491, 68962801, 293200159531, 1191694878666066510321450623792489136756229172407332230462797663298426983932272792657383336660801913848162204216417540955677965706955404313949733712340714861638106185597684745174398501025724130404133569866642454996521744281284226124355987843894614599718553178595963014434904833]
n = 135568509670260054049994954417860747085442883428459182441559553532993752593294067458983143521109377661295622146963670193783017382697726454953197805014428888491744355387957923382241961401063461549210355871385000347645387907568135032087942016502668629010859519249039662555733548461551175133582871220209515648241

c = 0x5d695edb47b81a303d162611f7d407579160ef8818929031e1e13ca20cb7094eddbb0658d95980e1753182c5d5c529fb45062891bb5da573c618e35df0103233ded582a53ed807846b19ea82be427f2bbc63e5c7eb685d8a22b2b7539cf45d4ad93bbf5b892b66288b568b6bbff6bb263d809475e6f0aa3cfd01539d8364c243

pro = 1
for i in  encryption_keys:
    pro =( pro * i ) % (n-1)

e = pro % (n-1)
print e
from wiener_attack import *

nlist = list()
elist = list()
clist = list()

nlist.append(n)
elist.append(e)
clist.append(c)

solutions = []
for i in range(0, len(elist)):
    (p,q,d) = wiener_attack(nlist[i],elist[i])
    if p != 0 and q != 0:
        solutions.append((nlist[i],clist[i],d))
    print "i: ", i
    print "p: ", p
    print "q: ", q
    print

for j in range(len(solutions)):
    (n,c,d) = solutions[j]
    plain = pow(c, d, n)
    print hex(plain)
    print hex(plain)[2:-1].decode('hex')
