import string
import sys
charset = string.digits + string.letters + "{}_"
MY_LUCKY_NUMBER = 29486316

encflag = [22583094738700, 6025662142726L, 13646663262645L, 20018878650456L, 14069991902668L, 6436597141358L, 7652301364604L, 6286512495700L, 15687704674065L, 10217922870359L, 3062823574577L, 4976478543305L, 277361814208L, 2436881762737L, 1619487832265L, 8295647218764L, 18099936976026L, 20000239646777L, 16370604780867L, 7096065029963L, 1040101670990L, 7534711038430L, 4608083643539L, 4311756968398L, 2257056353983L, 18690292678967L, 231956710453L, 17156634583158L, 14655928193819L, 6661137808140L, 8256551486779L, 11139286967312L, 215238711409L, 2746525703560L, 3441794022602L, 2906011677970L, 10383227818272L, 9539784113612L, 5342607059480L, 764433671800L, 9518237806315L, 15561131840194L, 10986985305300L, 720085057692L, 11964939175694L, 11028250755979L, 15745844427405L, 18888493041233L, 21049013106076L, 5550529038086L, 12287413160707L, 554065504198L, 2559165898376L, 16172264830644L, 8808498308913L, 3372607634112L, 6034730369976L, 7125400346130L, 9216680440105L, 2810732344199L, 8742307160568L, 5683159365787L, 3278398302520L, 7030154733974L, 6724218354885L, 6674778245214L, 7525534581298L, 1483891442208L, 8837362404215L, 702538439083L, 1591659685788L]

encflaga = [80426639646572, 36786119797560L, 25890835040518L, 29701484349268L, 798649358100L, 27887950798708L, 23313630715172L, 1422798829996L, 14177263094270L, 34779958269194L, 1441671337262L, 6451177365036L, 10365185181036L, 14665194368630L, 29638229624956L, 28726649616930L, 30540439438704L, 19196664474996L, 12051870555996L, 16601427069748L, 2673406087508L, 3553027724020L, 31265790830864L, 36202083459806L, 37050242278350L, 23386816338030L, 15113337402652L, 15880542558880L, 28786094317870L, 1773306149452L, 38367879121026L, 28994637466732L, 24238544422648L, 22125770828868L, 439914118142L, 1159810104984L, 17187096726508L, 28281904713276L, 16187530864548L, 8262874542204L, 20847374227444L, 13493945954996L, 29899900247628L, 7902986001420L, 261901547380L, 21383868897348L, 17137068351544L, 27461311423902L, 18305133065596L, 11870526259584L, 7031808150998L, 6513477979444L, 12278645050688L, 30518206028044L, 5308445291670L, 21652342506652L, 17762254354000L, 5234399615948L, 27649418333288L, 25692499210078L, 5593736874532L, 18233159109042L, 8761417864388L, 20352605091976L, 21613809913260L, 13472267339356L, 15952086270900L, 10946432685172L, 4432728385140L, 20515950339058L, 2482069189212L]

encflagb = [15745509083972, 15834032409066L, 4806295200272L, 42697876651800L, 29101332345496L, 52126506718999L, 9210198667408L, 40231050869748L, 30320166663754L, 31136025974738L, 16986293537872L, 2078242219651L, 6646504273272L, 9432965176086L, 15039218030053L, 13005900669491L, 19174309153666L, 48700336134113L, 8122368498578L, 23037402105121L, 35700739336938L, 28865902208508L, 43659452608255L, 46006898561428L, 20975735901919L, 42386271162509L, 38909268020015L, 27673526100529L, 36458397001370L, 13494106283676L, 27958004385554L, 29993895494656L, 40018865695246L, 33281526360974L, 19661935542956L, 32141045559358L, 2405067126692L, 19878709566452L, 8998086956484L, 6090952170756L, 3813233995708L, 7658537476919L, 3272112532411L, 16768551177660L, 37921530240856L, 3774863634088L, 14106758337710L, 31374691042821L, 34927455409800L, 21233912901644L, 5216539841029L, 36623768244483L, 36721154937912L, 20975216226336L, 1150922985132L, 46585333082902L, 35614797042132L, 29003898068928L, 1561967580801L, 11255054556490L, 43783872414480L, 46299293451667L, 40903569053498L, 10442106425082L, 19580129517219L, 16356261455522L, 3406940520742L, 8685895900682L, 91827538257L, 17703470559581L, 3983812593418L]

encflagc = [11106233133452, 72271518208827L, 7264718279890L, 17554832288800L, 45833624946296L, 64871560376203L, 23935786503596L, 27555977898804L, 54966930430722L, 69437411169161L, 59322645395726L, 14496942005765L, 17977051018482L, 8090856141947L, 10452998003692L, 38441339571975L, 40597464648534L, 49426262443949L, 19187206266426L, 61385632630017L, 63492974387360L, 46692900292689L, 17343059376676L, 46177515304927L, 1210665716384L, 5806931514469L, 39735008598136L, 9760857100791L, 17465130378954L, 17941768202428L, 62235649027894L, 60992184746706L, 43639102976060L, 66629003833942L, 25312678051988L, 23149767572802L, 67635240241324L, 71016355184564L, 42449181433412L, 23793679612112L, 11988032583114L, 57956443203205L, 26380481642776L, 13007193327708L, 64921067916476L, 22636479191463L, 26655732872462L, 36413962646163L, 5567214765508L, 44319734740647L, 53126427150382L, 81751844016817L, 12853826291224L, 21221823813328L, 55452967981578L, 36950527839098L, 54077956750596L, 15947823735522L, 18323158510330L, 31144005664015L, 70890519734020L, 16809475906719L, 20639936535680L, 32703326198673L, 39866137390622L, 23092479865930L, 16574555222920L, 26159124065774L, 6665451487224L, 60082709822061L, 2460300798856L]

flaglen = len(encflag)

encflag1 = []
encflag2 = []
encflag3 = []
encflag4 = []
for i in range(len(encflag)-1):
    encflag1.append(encflag[i] ^ MY_LUCKY_NUMBER)
    encflag2.append(encflaga[i] ^ MY_LUCKY_NUMBER)
    encflag3.append(encflagb[i] ^ MY_LUCKY_NUMBER)
    encflag4.append(encflagc[i] ^ MY_LUCKY_NUMBER)

encflag1.append((encflag[i] - (len(encflag) * MY_LUCKY_NUMBER)) ^ MY_LUCKY_NUMBER)
encflag2.append((encflaga[i] - (len(encflag) * MY_LUCKY_NUMBER)) ^ MY_LUCKY_NUMBER)
encflag3.append((encflagb[i] - (len(encflag) * MY_LUCKY_NUMBER)) ^ MY_LUCKY_NUMBER)
encflag4.append((encflagb[i] - (len(encflag) * MY_LUCKY_NUMBER)) ^ MY_LUCKY_NUMBER)
assert len(encflag1) == flaglen
assert len(encflag2) == flaglen
assert len(encflag3) == flaglen
# for i in range(len(encflag1)):
#     encflag1[i] = encflag1[i] ^ MY_LUCKY_NUMBER

# print len(encflag)
# print encflag1
# print encflag2
# print encflag3

for i in range(len(encflag1)):
#    sys.stdout.write("Possible Characters for " + str(i) + "  : ")
    l1 = []
    l2 = []
    l3 = []
    l4 = []
    for char in charset:
        if encflag1[i] % ord(char) == 0:
            l1.append(char)
    for char in charset:
        if encflag2[i] % ord(char) == 0:
            l2.append(char)
    for char in charset:
        if encflag3[i] % ord(char) == 0:
            l3.append(char)
    for char in charset:
        if encflag4[i] % ord(char) == 0:
            l4.append(char)
#    print("\n")
    print "Possible characters for " + str(i) + ": ", list(set(l1) & set(l2) & set(l3) & set(l4))
